<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hile Men√ºs√º</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #1a1a1a;
            color: #ffffff;
            margin: 0;
            padding: 0;
        }
        .hile-menu {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #2c2c2c;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }
        h2 {
            text-align: center;
            color: #ffcc00;
        }
        .control-panel, .user-panel {
            margin-bottom: 20px;
        }
        .control-panel input, .control-panel button {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            border: none;
            border-radius: 5px;
        }
        .control-panel button {
            background-color: #ff4444;
            color: #ffffff;
            cursor: pointer;
        }
        .control-panel button:hover {
            background-color: #ff6666;
        }
        .user-list {
            max-height: 200px;
            overflow-y: auto;
            background-color: #3c3c3c;
            border-radius: 5px;
            padding: 10px;
        }
        .user-button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px;
            margin: 5px 0;
            cursor: pointer;
            width: 100%;
            border-radius: 5px;
        }
        .user-button:hover {
            background-color: #45a049;
        }
        .footer {
            text-align: center;
            margin-top: 20px;
            font-size: 12px;
            color: #ffcc00;
        }
    </style>
</head>
<body>
    <div class="hile-menu">
        <div class="control-panel">
            <h2>üõ†Ô∏è Hile Men√ºs√º</h2>
            <div class="bot-counter">Botlar: 0</div>
            <input type="text" class="room-input" placeholder="Oda Kodu Girin..." oninput="updateRoomCode()">
            <input type="text" class="message-input" placeholder="Mesaj Girin...">
            <button class="send-button" onclick="window.sendMessage()">Mesaj G√∂nder</button>
            <input type="text" class="bot-nick" placeholder="Bot Takma Adƒ±...">
            <div class="avatar-container">
                <input type="number" class="avatar-input" placeholder="Avatar" min="0" max="36" oninput="window.updateAvatarPreview(this.value)">
                <label class="avatar-switch">
                    <input type="checkbox" onchange="window.toggleRandomAvatar()">
                    <span class="slider"></span>
                </label>
                <span style="color: #89CFF0;">Rastgele Avatar</span>
                <img class="avatar-preview">
            </div>
            <button class="apply-button" onclick="window.applySettings()">Ayarlarƒ± Uygula</button>
            <button class="toggle-button" onclick="window.toggleBot()">Botlarƒ± Ba≈ülat</button>
            <button class="exit-button" onclick="window.exitFromRooms()">Odadan √áƒ±k</button>
            <button class="report-button" onclick="window.sendReport()">Rapor G√∂nder</button>
            <button class="draw-button" onclick="window.autoDraw()">Otomatik √áizim</button>
        </div>
        <div class="user-panel">
            <h2>üë• Kullanƒ±cƒ± Listesi</h2>
            <div class="user-list"></div>
        </div>
        <div class="footer">Made by Neo</div>
    </div>
    <script>
        (function() {
            'use strict';

            const config = {
                Rooms: [],
                proxies: ["https://www.blockaway.net/"],
                playerName: "",
                roomCode: "",
                delayBetweenEntries: 500,
                reexecutionDelay: 1900,
                randomAvatar: false,
                selectedAvatar: 0,
                settings: {
                    nickName: "",
                    roomCode: "",
                    avatarId: 0
                }
            };

            let wsList = [];
            let isRunning = false;
            let messageInterval;
            let mainInterval;
            let afkIntervals = [];
            let isAfkPaused = false;
            let roomusers = [];
            let kickedUsers = new Set();
            let userListUpdateInterval;

            const drawCommands = [
                '[6,"13"]',
                '[5,"xFFC926"]',
                '[3,0,0,767,448]',
                '[5,"xFFFFFF"]',
                '[1,6,215,97,200,317]',
                '[1,6,219,102,256,314]',
                '[1,6,282,99,291,315]',
                '[1,6,336,110,290,227]',
                '[1,6,197,264,251,257]',
                '[1,6,380,112,379,309]',
                '[1,6,365,87,390,73]',
                '[1,6,289,224,329,312]',
                '[1,6,422,118,484,147]',
                '[1,6,486,150,434,217]',
                '[1,6,420,115,425,311]',
                '[1,6,433,220,475,315]',
                '[1,6,529,100,509,314]',
                '[1,6,531,108,565,320]',
                '[1,6,510,243,563,242]'
            ];

            window.toggleBot = toggleBot;
            window.sendMessage = sendMessage;
            window.exitFromRooms = exitFromRooms;
            window.autoDraw = autoDraw;
            window.toggleRandomAvatar = toggleRandomAvatar;
            window.updateAvatarPreview = updateAvatarPreview;
            window.applySettings = applySettings;
            window.sendReport = sendReport;

            function loadSettings() {
                const savedSettings = localStorage.getItem('frozenBotSettings');
                if(savedSettings) {
                    config.settings = JSON.parse(savedSettings);
                    document.querySelector('.bot-nick').value = config.settings.nickName;
                    document.querySelector('.room-input').value = config.settings.roomCode;
                    document.querySelector('.avatar-input').value = config.settings.avatarId;
                    updateAvatarPreview(config.settings.avatarId);
                    updateRoomCode();
                }
            }

            function updateUserList() {
                const userListElement = document.querySelector('.user-list');
                const botNick = document.querySelector('.bot-nick').value.trim();
                userListElement.innerHTML = '';
                const addedUsers = new Set();

                wsList.forEach(ws => {
                    if (ws.readyState === WebSocket.OPEN) {
                        ws.send('42[32]');
                    }
                });

                roomusers.forEach(user => {
                    if (user.nick && 
                        user.nick !== "kirallah" && 
                        !addedUsers.has(user.id) && 
                        !user.nick.replace(/\s+/g, '').includes(botNick.replace(/\s+/g, ''))) {
                        const button = document.createElement('button');
                        button.className = 'user-button';
                        button.textContent = user.nick;
                        button.onclick = () => kickUser(user.id, user.nick);
                        userListElement.appendChild(button);
                        addedUsers.add(user.id);
                    }
                });
            }

            function kickUser(userId, userNick) {
                if (!kickedUsers.has(userId)) {
                    wsList.forEach(ws => {
                        if (ws.readyState === WebSocket.OPEN) {
                            ws.send(`42[11,${ws.id},"kick ${userNick}"]`);
                            setTimeout(() => {
                                ws.send(`42[45,${ws.id},["${userId}",true]]`);
                                ws.send(`42[45,${ws.id},["${userId}",false]]`);
                            }, 100);
                        }
                    });
                    kickedUsers.add(userId);
                    updateUserList();
                }
            }

            function applySettings() {
                config.settings.nickName = document.querySelector('.bot-nick').value;
                config.settings.roomCode = document.querySelector('.room-input').value;
                config.settings.avatarId = parseInt(document.querySelector('.avatar-input').value) || 0;
                localStorage.setItem('frozenBotSettings', JSON.stringify(config.settings));
                updateRoomCode();
            }

            function generateInvisibleChar() {
                const invisibleChars = ['\u200B', '\u200C', '\u200D', '\u2061', '\u2062', '\u2063', '\u2064', '\u2066', '\u17b4', '\u17b5', '\u2068', '\u2069'];
                return invisibleChars[Math.floor(Math.random() * invisibleChars.length)];
            }

            function addInvisibleCharsToMessage(message) {
                let result = '';
                for (let i = 0; i < message.length; i++) {
                    result += message[i] + generateInvisibleChar();
                }
                return result;
            }

            function getRandomName() {
                let name = document.querySelector('.bot-nick').value.trim();
                let result = '';
                for (let i = 0; i < name.length; i++) {
                    result += name[i] + generateInvisibleChar();
                }
                result += generateInvisibleChar();
                return result.trim();
            }

            function setRandomPlayerName() {
                config.playerName = getRandomName();
            }

            function updateRoomCode() {
                const roomInput = document.querySelector('.room-input');
                const roomCode = roomInput.value.trim();
                if(roomCode) {
                    config.Rooms = [roomCode];
                    config.settings.roomCode = roomCode;
                }
            }

            function autoDraw() {
                isAfkPaused = true;
                setTimeout(() => { isAfkPaused = false; }, 7000);
                
                wsList.forEach(ws => {
                    if(ws.readyState === WebSocket.OPEN) {
                        ws.send(`42[34,${ws.id}]`);
                        let index = 0;
                        const drawInterval = setInterval(() => {
                            if(index < drawCommands.length) {
                                ws.send(`42[10,${ws.id},${drawCommands[index]}]`);
                                index++;
                            } else {
                                clearInterval(drawInterval);
                            }
                        }, 50);
                    }
                });
            }

            function exitFromRooms() {
                wsList.forEach(ws => {
                    if (ws.readyState === WebSocket.OPEN) {
                        ws.send(`42[11,${ws.id},"q"]`);
                        setTimeout(() => {
                            ws.send(`42[24,${ws.id}]`);
                        }, 100);
                    }
                });
                wsList = [];
                roomusers = [];
                updateUserList();
                kickedUsers.clear();
                document.querySelector('.bot-counter').textContent = 'Botlar: 0';
            }

            function sendReport() {
                wsList.forEach(ws => {
                    if (ws.readyState === WebSocket.OPEN) {
                        ws.send(`42[35,${ws.id}]`);
                    }
                });
            }

            async function enterRoom(roomCode) {
                setRandomPlayerName();
                try {
                    const logoutResponse = await fetch("https://gartic.io/logout");
                    if (!logoutResponse.ok) throw new Error('√áƒ±kƒ±≈ü ba≈üarƒ±sƒ±z');

                    const roomResponse = await fetch("https://gartic.io/server?check=1&v3=1&room=" + roomCode);
                    if (!roomResponse.ok) throw new Error('Oda kontrol√º ba≈üarƒ±sƒ±z');

                    const roomText = await roomResponse.text();
                    const server = roomText.split("//")[1].split(".")[0];
                    const ccode = roomText.split("c=")[1];

                    const ws = new WebSocket('wss://' + server + '.gartic.io/socket.io/?c=' + ccode + '&EIO=3&transport=websocket');
                    wsList.push(ws);

                    ws.onopen = () => {
                        let botData = {
                            v: 20000,
                            nick: getRandomName(),
                            avatar: config.randomAvatar ? Math.floor(Math.random() * 36) : config.selectedAvatar,
                            platform: 0,
                            sala: roomCode.slice(-4)
                        };
                        ws.send(`42[3,${JSON.stringify(botData)}]`);
                    };

                    ws.onmessage = (msg) => {
                        if (msg.data.indexOf('42["5"') !== -1) {
                            let objlist = JSON.parse('["5"' + msg.data.split('42["5"')[1]);
                            ws.id = objlist[2];
                            roomusers = objlist[5];
                            updateUserList();
                            updateBotCounter();
                            startAntiAfk(ws.id);
                            setTimeout(() => {
                                ws.send(`42[11,${ws.id},"sa"]`);
                            }, 10);
                        }
                        if (msg.data.indexOf('42["23"') !== -1) {
                            let user = JSON.parse("{" + msg.data.split("{")[1].split("}")[0] + "}");
                            if (!roomusers.some(existingUser => existingUser.id === user.id)) {
                                roomusers.push(user);
                                updateUserList();
                            }
                        }
                        if (msg.data.indexOf('42["24"') !== -1) {
                            let userId = msg.data.split(",")[1].split('"')[1];
                            roomusers = roomusers.filter(u => u.id !== userId);
                            updateUserList();
                        }
                        if (msg.data.indexOf('42["33"') !== -1) {
                            try {
                                let userList = JSON.parse(msg.data.split('42["33",')[1]);
                                roomusers = userList;
                                updateUserList();
                            } catch(e) {
                                console.error(e);
                            }
                        }
                    };
                } catch (error) {
                    console.error(error);
                }
            }

            function startAntiAfk(botId) {
                const interval = setInterval(() => {
                    if (!isAfkPaused) {
                        wsList.forEach(ws => {
                            if (ws.readyState === WebSocket.OPEN && ws.id === botId) {
                                ws.send(`42[25,${botId}]`);
                            }
                        });
                    }
                }, 5000);
                afkIntervals.push(interval);
            }

            function updateBotCounter() {
                let botCounter = document.querySelector('.bot-counter');
                let currentBots = parseInt(botCounter.textContent.split(': ')[1]);
                botCounter.textContent = `Botlar: ${currentBots + 1}`;
            }

            function toggleRandomAvatar() {
                const switch_elem = document.querySelector('.avatar-switch input');
                const avatar_input = document.querySelector('.avatar-input');
                config.randomAvatar = switch_elem.checked;
                avatar_input.disabled = config.randomAvatar;
                if(config.randomAvatar) {
                    avatar_input.value = '';
                    updateAvatarPreview('');
                }
            }

            function updateAvatarPreview(value) {
                const preview = document.querySelector('.avatar-preview');
                const numValue = parseInt(value);
                if(numValue >= 0 && numValue <= 36) {
                    preview.src = `https://gartic.io/static/images/avatar/svg/${numValue}.svg`;
                    preview.style.display = 'inline';
                    config.selectedAvatar = numValue;
                    config.settings.avatarId = numValue;
                } else {
                    preview.style.display = 'none';
                }
            }

            function sendMessage() {
                const messageInput = document.querySelector('.message-input');
                const message = messageInput.value;
                if (message && wsList.length > 0) {
                    const firstBot = wsList[0];
                    if (firstBot && firstBot.readyState === WebSocket.OPEN) {
                        firstBot.send(`42[11,${firstBot.id},"${addInvisibleCharsToMessage(message)}"]`);
                    }
                }
            }

            function toggleBot() {
                const toggleButton = document.querySelector('.toggle-button');
                isRunning = !isRunning;
                toggleButton.textContent = isRunning ? 'Botlarƒ± Durdur' : 'Botlarƒ± Ba≈ülat';
                toggleButton.style.backgroundColor = isRunning ? '#ff4444' : '#4CAF50';

                if (isRunning) {
                    enterAllRooms();
                    mainInterval = setInterval(enterAllRooms, config.reexecutionDelay);
                } else {
                    clearInterval(mainInterval);
                }
            }

            async function enterAllRooms() {
                if (!isRunning) return;
                for (const roomCode of config.Rooms) {
                    await enterRoom(roomCode);
                    await new Promise(resolve => setTimeout(resolve, config.delayBetweenEntries));
                }
            }

            init();
        })();
    </script>
</body>
</html>
